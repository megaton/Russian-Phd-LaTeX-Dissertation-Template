
{\actuality} Конструктивно-блочное представление (Constructive Solid Geometry, CSG) используется в современных САПР в основном как вспомогательное или промежуточное представление, для выполнения булевых операций над телами. Для моделирования тел, получаемых аддитивными (3d-печать) и субтрактивными (фрезерование) методами CSG представление остается наиболее естественным. В таких задачах отказ от дополнительных схем представления (граничное представление, воксельное представление) позволил бы значительно упростить соответствующие САПР, повысить быстродействие систем. Для этого требуется устранить один из главных недостатков CSG представления: невозможность интерактивной визуализации сложных CSG моделей (время фотореалистичной визуализации CSG-модели средней сложности для лучших их существующих алгоритмов трассировки составляет порядка десятков секунд), что сделало бы возможным развитие САПР, использующих CSG как основное представление твердых тел.

Визуализация CSG активно исследовалась в 80-х и 90-х годах, что подтверждается значительным числом публикаций, среди которых следует отметить работы R. Goldstein, A. Ricci, S. Roth, A. Requicha, P. Atheron, W. Bronsvoort, N. Okino, J. Rossignac, J. Goldfeather, T. Duff, N. Stewart. Первые работы по визуализации CSG использовали трассировку лучей для получения изображения. Однако, в то время это подход не позволял достичь интерактивной визуализации даже на простых сценах. Позже, с распространением аппаратной поддержки растеризации, были разработаны алгоритмы, основанные на растеризации  CSG примитивов и использовании буфера глубины, которые позволяли интерактивно визуализировать простые сцены (от десятков до тысяч примитивов). С тех пор, в связи с развитием графических процессоров и появлением новых исследований в области ускоряющих структур (acceleration structures), появилась возможность разрабатывать новые, более эффективные, алгоритмы визуализации CSG моделей, оптимизированные для выполнения на современных графических процессорах. В новых условиях, вновь актуальной оказывается трассировка лучей. Использование трассировки лучей позволяет использовать более простые алгоритмы (проблема сводится к одномерной) и свести вычисления к массивно параллельным с выполнением алгоритма каждого луча на графическом процессоре (GPU). Также, использование трассировки лучей в качестве основы для алгоритма визуализации CSG позволяет расширить его до полноценного алгоритма глобального освещения.

Методы глобального освещения традиционно используются в компьютерной графике для синтеза фотореалистичных изображений. Программное обеспечение на их основе применяется в киноиндустрии, рекламе, САПР, дизайне помещений и офисов, компьютерных играх и симуляторах, а также во многих других системах виртуальной реальности. Расчет глобального освещения – вычислительно трудоемкая задача, для решения которой применяются высокопроизводительные распределенные системы.
Традиционный способ визуализации динамических 3D сцен в реальном времени основан на растеризации, которая аппаратно ускоряется графическими процессорами. Однако растеризация не позволяет обрабатывать вторичное освещение и физически достоверные модели материалов и источников света. В то время как алгоритмы, основанные на трассировке лучей, позволяют получить все необходимые эффекты глобального освещения. Ведущими производителями графических процессоров анонсирована аппаратная поддержка трассировки лучей (Nvidia RTX), что, в перспективе, позволит дополнительно ускорить работу решения.

{\aim} диссертационного исследования является разработка решения для интерактивной фотореалистичной визуализации сложных CSG моделей (содержащих миллионы примитивов).

Поставленная цель требует решения следующих задач:
\begin{enumerate}
  \item Исследовать существующие алгоритмы визуализации CSG моделей и возможность их применения на современных графических процессорах.
  \item Разработать алгоритм визуализации CSG моделей, адаптированный для современных графических процессоров и совместимый с высокопроизводительными методами глобального освещения.
  \item Разработать ускоряющую структуру, которая обеспечивает быстрое построение (при изменении структуры CSG дерева) и высокую скорость визуализации.
  \item Разработать программный комплекс, реализующий предложенное решение с использованием инструментов параллельного программирования графических процессоров (OpenGL Compute Shaders).
  \item Проверить корректность работы алгоритма визуализации путем сравнения полученных изображений с результатами работы других алгоритмов.
  \item Оценить (и сравнить с аналогами) быстродействие программного комплекса, реализованных моделей и методов в задачах технической визуализации и фотореалистичной визуализации CSG моделей.
\end{enumerate}

\textbf{Предметом исследования} являются модели, методы и системные решения для  интерактивного синтеза фотореалистичных изображений сложных CSG сцен методами глобального освещения; алгоритмизация методов глобального освещения; способы представления, хранения и передачи моделей 3D сцен, допускающие эффективную  обработку на GPU; методы распараллеливания алгоритмов глобального освещения на массивно-параллельных GPU; современные технологии объектно-ориентированного программирования и метапрограммирования.

{\methods} Решение задач диссертационной работы базируется на: теоретических основах информатики, методах и моделях компьютерной графики, численных методах, теоретических основах и моделях аналитической геометрии, теории алгоритмов и структур данных, а также методах параллельных вычислений.

{\novelty} Получены следующие новые результаты в области интерактивного синтеза изображений CSG сцен методами глобального освещения на графическом процессоре:


\begin{enumerate}
  \item Эффективная процедура оптимизации CSG дерева, включающая пространственную сортировку на базе методов построения иерархии ограничивающих объемов.
  \item Интерактивный алгоритм пересечения луча с конструктивной геометрией, минимизирующий объем памяти, необходимый для поддержки состояния луча, адаптированный для массивно-параллельных архитектур.
  \item Прямая фотореалистичная визуализация CSG модели методом оптимизированной («усеченной») двунаправленной трассировки путей.
\end{enumerate}

{\influence}. С точки зрения практической значимости интерес представляет разработанный программный комплекс и отдельные его компоненты:

\begin{enumerate}
  \item Высокоуровневая библиотека программ для интерактивной визуализации конструктивной геометрии GPU (техническая и фотореалистичная визуализация), которая может встраиваться в существующие либо новые САПР и применяться для разработки общих и специализированных систем визуализации с заданными свойствами.
  \item Автономная система синтеза изображений CSG моделей в интерактивном режиме. Система может служить методическим пособием к вузовским курсам по компьютерной графике и автоматизированному проектированию.
\end{enumerate}

{\defpositions}
\begin{enumerate}
  \item Эффективная процедура оптимизации CSG дерева, включающая пространственную сортировку на базе методов построения иерархии ограничивающих объемов.
  \item Интерактивный алгоритм пересечения луча с конструктивной геометрией, минимизирующий объем памяти, необходимый для поддержки состояния луча, адаптированный для массивно-параллельных архитектур.
  \item Прямая фотореалистичная визуализация CSG модели (без перехода к граничному представлению) методом оптимизированной («усеченной») двунаправленной трассировки путей.
  \item Высокоуровневая программная библиотека для интерактивной визуализации конструктивной геометрии GPU (техническая и фотореалистичная визуализация), которая может встраиваться в существующие либо новые САПР и применяться для разработки общих и специализированных систем визуализации с заданными свойствами.
\end{enumerate} 

{\reliability} результатов подтверждена путем сравнения полученных изображений с результатами работы других алгоритмов визуализации конструктивной геометрии, а также путем сравнения с эталонными изображениями для фотореалистичной визуализации.

{\probation}
Основные результаты доложены и обсуждены на: международных конференциях по компьютерной графике и зрению GraphiCon (Санкт-Петербург, 2010; Москва, 2011, 2012;  Нижний Новгород, 2016); всероссийской конференции «Высокопроизводительные параллельные вычисления на кластерных системах» (Нижний Новгород, 2011); международной научной конференции по компьютерной графике, визуализации, компьютерному зрению WSCG'2013 (Пльзень, Чехия, 2013); X Международной научной конференции «Параллельные вычислительные технологии 2016» (ПаВТ-2016, Архангельск).

% {\contribution} Автор принимал активное участие \ldots

%\publications\ Основные результаты по теме диссертации изложены в ХХ печатных изданиях~\cite{Sokolov,Gaidaenko,Lermontov,Management},
%Х из которых изданы в журналах, рекомендованных ВАК~\cite{Sokolov,Gaidaenko}, 
%ХХ --- в тезисах докладов~\cite{Lermontov,Management}.

\ifnumequal{\value{bibliosel}}{0}{% Встроенная реализация с загрузкой файла через движок bibtex8
    \publications\ Основные результаты по теме диссертации изложены в XX печатных изданиях, 
    X из которых изданы в журналах, рекомендованных ВАК, 
    X "--- в тезисах докладов.%
}{% Реализация пакетом biblatex через движок biber
%Сделана отдельная секция, чтобы не отображались в списке цитированных материалов
    \begin{refsection}[vak,papers,conf]% Подсчет и нумерация авторских работ. Засчитываются только те, которые были прописаны внутри \nocite{}.
        %Чтобы сменить порядок разделов в сгрупированном списке литературы необходимо перетасовать следующие три строчки, а также команды в разделе \newcommand*{\insertbiblioauthorgrouped} в файле biblio/biblatex.tex
        \printbibliography[heading=countauthorvak, env=countauthorvak, keyword=biblioauthorvak, section=1]%
        \printbibliography[heading=countauthorconf, env=countauthorconf, keyword=biblioauthorconf, section=1]%
        \printbibliography[heading=countauthornotvak, env=countauthornotvak, keyword=biblioauthornotvak, section=1]%
        \printbibliography[heading=countauthor, env=countauthor, keyword=biblioauthor, section=1]%
        \nocite{%Порядок перечисления в этом блоке определяет порядок вывода в списке публикаций автора
                % vakbib1,vakbib2,%
                % confbib1,confbib2,%
                % bib1,bib2,%
        }%
        \publications\ Основные результаты по теме диссертации изложены в \arabic{citeauthor} печатных изданиях, 
        \arabic{citeauthorvak} из которых изданы в журналах, рекомендованных ВАК, 
        \arabic{citeauthorconf} "--- в тезисах докладов.
    \end{refsection}
    \begin{refsection}[vak,papers,conf]%Блок, позволяющий отобрать из всех работ автора наиболее значимые, и только их вывести в автореферате, но считать в блоке выше общее число работ
        \printbibliography[heading=countauthorvak, env=countauthorvak, keyword=biblioauthorvak, section=2]%
        \printbibliography[heading=countauthornotvak, env=countauthornotvak, keyword=biblioauthornotvak, section=2]%
        \printbibliography[heading=countauthorconf, env=countauthorconf, keyword=biblioauthorconf, section=2]%
        \printbibliography[heading=countauthor, env=countauthor, keyword=biblioauthor, section=2]%
        % \nocite{vakbib2}%vak
        % \nocite{bib1}%notvak
        % \nocite{confbib1}%conf
    \end{refsection}
}

% При использовании пакета \verb!biblatex! для автоматического подсчёта
% количества публикаций автора по теме диссертации, необходимо
% их~здесь перечислить с использованием команды \verb!\nocite!.
